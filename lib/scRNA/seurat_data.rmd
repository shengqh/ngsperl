---
title: "Seurat data preparation"
date: "`r format(Sys.Date(), '%m/%d/%Y')`"
output: 
  rmdformats::readthedown:
    toc_depth: 2
    number_sections: true
---

```{r setup, include=FALSE}
library(knitr)
library(dplyr)
library(kableExtra)
knitr::opts_chunk$set(echo=FALSE,  message=FALSE, warning=FALSE, results = 'asis', fig.width=7, fig.height = 7,tidy = TRUE, tidy.opts = list(comment = FALSE))
```

```{css, echo=FALSE}
#content{
    max-width:1920px;
}
```

```{r data, include=FALSE}
source("reportFunctions.R")
source("scRNA_func.r")

options_table<-read.table("fileList1.txt", sep="\t", header=F, stringsAsFactors = F)
myoptions<-split(options_table$V1, options_table$V2)

outFile=myoptions$task_name
is_preprocessed=is_one(myoptions$is_preprocessed)

```

# elbowplot

```{r, results="asis", echo=FALSE}
include_graphics(paste0(outFile,".elbowplot.pca.png"))
```

# Sample cells

```{r, results="asis", echo=FALSE, eval=!is_preprocessed}
tbl<-read.csv(paste0(outFile, ".filtered.cell.csv"))
print(kable(tbl, row.names=F) %>%	kable_styling())
```

```{r, results="asis", echo=FALSE, eval=is_preprocessed}
tbl<-fread(paste0(outFile, ".Ident.cell.txt"))
print(kable(tbl, row.names=F) %>%	kable_styling())
```

```{r, results="asis", echo=FALSE}
include_graphics(paste0(outFile,".Ident.cell.bar.png"))
```

```{r, results="asis", echo=FALSE, eval=!is_preprocessed}
cat("\n\n# Filtering cutoffs\n\n")
include_graphics(paste0(outFile,".qc.1.png"))
```

```{r, results="asis", echo=FALSE, eval=!is_preprocessed}
cat("\n\n# Number of reads ~ percentage of mitochondral\n\n")
include_graphics(paste0(outFile,".qc.2.png"))
```

```{r, results="asis", echo=FALSE, eval=!is_preprocessed}
cat("\n\n# Number of features ~ percentage of mitochondral\n\n")
include_graphics(paste0(outFile,".qc.3.png"))
```

```{r, results="asis", echo=FALSE, eval=!is_preprocessed}
cat("\n\n# Sample characters after filtering\n\n")
include_graphics(paste0(outFile,".qc.4.png"))
```

# Sample UMAP

```{r, results="asis", echo=FALSE}
include_graphics(paste0(outFile,".Ident.png"))
```

# Sample exp UMAP

```{r, results="asis", echo=FALSE}
include_graphics(paste0(outFile,".Ident.qc.exp.png"))
```
